# Ktoggl CLI

**Ktoggl CLI** vous permet de g√©n√©rer vos timesheets / fichiers de pointages via le logiciel [**Toggl Track**](https://toggl.com/track/toggl-desktop/).

**Ktoggl CLI n'est pas affili√© √† la marque / soci√©t√© / logiciel Toggl.**

## Fonctionnalit√©s

### Export pointages **SAP CATS** üêà

![](./readme-resources/toggl-to-sap.png)

‚ö†Ô∏è La seule contrainte de cette feature est que les informations des projets point√©s doivent se trouver dans le titre du
projet. En effet, avec la version gratuite de **Toggl**, vous ne pouvez pas avoir acc√®s aux **Tasks**. Prenez cela comme
un workaround ü§ì

Les projets dans **Ktoggl CLI** doivent √™tre sous cette
forme : `id_projet description_projet id_t√¢che description_t√¢che` pour repr√©senter au mieux le fonctionnement de **SAP CATS**.

Si un nom de client est disponible, il faut le rajouter aussi (*Attention √† la casse !*) :

![](./readme-resources/project-formating-example.png)

C'est la seule manipulation n√©cessaire en amont pour que la g√©n√©ration du fichier *Excel* fonctionne.

Exemple de commande pour g√©n√©rer ce fichier :

- Avec le fichier **JAR** :

```shell
$ java -jar ktoggl-cli-0.0.2.jar sap --api-key <votre_clef_api_toggl> --workspace <le_workspace_id_cibl√©> --since 2021-04-15 -g
```

- Avec **DockerHub** [Ktoggl-CLI](https://hub.docker.com/r/remylavergne/ktoggl-cli) *(prendre la derni√®re version)* üê≥:

```shell
$ docker pull remylavergne/ktoggl-cli:0.0.2

$ docker run -it --rm -v $PWD/output:/usr/src/ktoggl/ktoggl-cli-output remylavergne/ktoggl-cli:0.0.2


bash-4.4# ktoggl-cli sap --api-key <votre_clef_api_toggl> --workspace <le_workspace_id_cibl√©> --since 2021-04-15 -g
```

- Avec le **Dockerfile** *(prendre la derni√®re version)* :

```shell
$ docker build --no-cache --rm -t remylavergne/ktoggl-cli:0.0.2 .

$ docker run -it --rm -v $PWD/output:/usr/src/ktoggl/ktoggl-cli-output remylavergne/ktoggl-cli:0.0.2

bash-4.4# ktoggl-cli sap --api-key <votre_clef_api_toggl> --workspace <le_workspace_id_cibl√©> --since 2021-04-15 -g
```

`--api-key`, `-a` : Votre clef API se trouve dans vos param√®tres de compte Toggl <br />
`--workspace`, `-w` : L'id du workspace vis√© (se trouve facilement dans l'url)<br />
`--since`, `-s` : Date de d√©but pour la r√©cup√©ration des donn√©es<br />
`--until`, `-u` : Date de fin pour la r√©cup√©ration des donn√©es (si vide, le jour actuel est pris en compte)<br />
`-g` / `--no-group` : Grouper / ne pas grouper les m√™mes projets sur une journ√©e<br />

A la fin du processus, des logs permettent d'avoir un aper√ßu de ce qui a √©t√© g√©n√©r√©, avec les diff√©rences de temps en
plus, ou en moins.

Exemple de r√©sultat (‚ö†Ô∏è ceci risque de changer dans le temps) :

```bash
-> (2021-04-05 to 2021-04-22) Excel generation done with 100 entries

-> Summary
14 days exported
Total: 110.0 hours
Total expected: 112 hours

-> Differences based on 8 hours shift / day:
- 2021-04-22: - 1.0
- 2021-04-21: - 1.5
- 2021-04-20: + 0.25
- 2021-04-19: - 0.25
- 2021-04-16: + 0.25
- 2021-04-15: + 0.5
- 2021-04-12: + 0.5
- 2021-04-09: - 0.25
- 2021-04-08: - 0.25
- 2021-04-06: + 2.5
- 2021-04-05: - 7.25
```

Le fichier Excel g√©n√©r√© est directement importable dans **SAP CATS**. Vous pouvez ainsi ajuster vos pointages avec le
compte rendu.

![](./readme-resources/excel-export-example.png)

Vous remarquerez que les heures ont √©t√© arrondies au quart sup√©rieur, ou inf√©rieur, pour respecter le standard de
pointage de **SAP CATS**.

Vous pouvez maintenant uploader cet Excel dans votre **SAP CATS**.
